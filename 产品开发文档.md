# 产品开发文档

## 一、产品概述

AD辅助系统是一款面向医疗健康领域的智能管理平台，主要服务于阿尔茨海默症（AD）患者的管理、虚拟陪伴与个性化关怀。系统通过数字化手段提升患者管理效率，丰富患者生活体验，辅助医护与家属实现高效协作。

### 产品目标
- 实现患者信息的数字化管理
- 提供虚拟人陪伴与互动功能
- 支持个性化回忆知识库，提升患者幸福感
- 前后端分离，便于扩展与维护

---

## 二、主要功能与业务流程

1. **用户注册与登录**：支持医护、家属等用户注册、登录，保障数据安全。
2. **患者管理**：包括患者信息录入、查询、编辑、删除，支持个性化回忆管理。
3. **虚拟人管理**：支持医生/亲属虚拟人形象与声音的自定义、管理与互动。
4. **个性化回忆知识库**：为每位患者建立专属回忆库，支持文本、图片等多种形式。
5. **系统首页与统计**：展示系统数据总览、快速入口、最近活动与系统特色。
6. **文件上传**：支持图片、音频等文件的上传与管理。

---

## 三、用户角色与权限

| 角色   | 权限说明                                   |
|--------|--------------------------------------------|
| 医护   | 全部功能，含患者与虚拟人管理、回忆编辑等   |
| 家属   | 查看患者信息、虚拟人互动、部分回忆编辑     |
| 管理员 | 用户管理、系统配置、数据统计               |

---

## 四、系统架构与技术选型

- **前端**：React 19、Vite、Tailwind CSS、React Router、Recharts、@tanstack/react-query
- **后端**：Python（推荐 FastAPI 框架，支持异步、自动生成接口文档、性能优良）
- **数据库建议**：MongoDB、PostgreSQL、MySQL
- **文件存储**：本地或云存储（如阿里云OSS、七牛云等）
- **接口通信**：RESTful API，推荐 JWT 认证

系统采用前后端分离架构，前端负责页面渲染与交互，后端负责数据处理与业务逻辑。

---

## 五、详细功能模块说明

### 1. 用户认证
- 注册、登录、登出，支持 JWT 认证
- 权限校验，未登录用户自动跳转登录页

### 2. 患者管理
- 患者信息录入、编辑、删除、查询
- 个性化回忆知识库（文本/图片，支持增删改查）
- 回忆内容支持时间戳、图片预览、编辑模式

### 3. 虚拟人管理
- 医生/亲属虚拟人形象与声音自定义
- 形象、声音、Agent类型可选与上传
- 支持虚拟人详情编辑、试听与预览

### 4. 系统首页与统计
- 展示患者、虚拟人等核心数据统计
- 快速入口、最近活动、系统特色展示
- 响应式布局，适配多终端

### 5. 文件上传
- 图片、音频等文件上传，支持本地与云存储
- 文件大小、类型校验，安全合规

---

## 六、数据结构与接口设计（简要）

### 1. 主要数据模型

- **Patient**：id, name, gender, age, history, memories[]
- **Memory**：id, type(text/image), content, createdAt, updatedAt
- **Avatar**：id, name, description, image, voice, agent, type

### 2. 主要接口（RESTful）

- 用户认证：/api/register, /api/login, /api/logout
- 患者管理：/api/patients, /api/patients/:id
- 回忆管理：/api/patients/:id/memories
- 虚拟人管理：/api/avatars, /api/avatars/:id
- 文件上传：/api/upload/image, /api/upload/voice

接口返回统一格式：
```json
{
  "code": 0,
  "msg": "success",
  "data": { ... }
}
```

---

## 七、后端实现建议（Python FastAPI）

### 1. 技术选型
- **主框架**：FastAPI（高性能、自动生成Swagger文档、异步支持）
- **ORM推荐**：SQLModel、SQLAlchemy（关系型数据库）或 ODMantic（MongoDB）
- **认证**：fastapi-jwt-auth 或 fastapi-users
- **文件上传**：FastAPI内置支持，推荐与云存储SDK结合
- **依赖管理**：pip/conda/poetry

### 2. 目录结构建议
```
backend/
├── app/
│   ├── main.py           # FastAPI入口
│   ├── models.py         # 数据模型
│   ├── schemas.py        # Pydantic数据校验
│   ├── crud.py           # 业务逻辑
│   ├── api/              # 路由分发
│   ├── deps.py           # 依赖注入
│   └── utils.py          # 工具函数
├── requirements.txt      # 依赖包
└── ...
```

### 3. 关键代码片段示例

#### FastAPI 路由示例
```python
from fastapi import FastAPI, Depends, HTTPException
from pydantic import BaseModel

app = FastAPI()

class Patient(BaseModel):
    id: str
    name: str
    gender: str
    age: int
    history: str

@app.post("/api/patients")
def create_patient(patient: Patient):
    # 业务逻辑
    return {"code": 0, "msg": "success", "data": patient}
```

#### JWT 认证集成
```python
from fastapi_jwt_auth import AuthJWT

@AuthJWT.load_config
def get_config():
    return Settings()

@app.get("/api/patients")
def list_patients(Authorize: AuthJWT = Depends()):
    Authorize.jwt_required()
    # 返回患者列表
```

#### 文件上传示例
```python
from fastapi import File, UploadFile

@app.post("/api/upload/image")
def upload_image(file: UploadFile = File(...)):
    # 保存文件并返回URL
    return {"code": 0, "msg": "success", "data": {"url": "..."}}
```

### 4. 部署建议
- 推荐使用 Uvicorn/Gunicorn 作为 ASGI 服务器
- 可通过 Docker 容器化部署，便于扩展与运维
- 数据库、文件存储等敏感信息通过环境变量管理
- 日志与监控建议集成（如Prometheus、ELK）

---

## 八、交互流程与页面导航

- 登录/注册 → 首页（仪表盘）
- 首页 → 患者管理/虚拟人管理/统计
- 患者管理 → 患者列表 → 新增/详情/编辑/回忆库
- 虚拟人管理 → 虚拟人列表 → 新增/详情/编辑
- 文件上传在相关表单内嵌入

页面导航示意：
- `/login` 登录
- `/register` 注册
- `/` 首页
- `/patients` 患者列表
- `/patients/add` 新增患者
- `/patients/:id` 患者详情
- `/avatars` 虚拟人列表
- `/avatars/add` 新增虚拟人
- `/avatars/:id` 虚拟人详情

---

## 九、安全与合规

- 用户数据加密存储，接口需鉴权
- 文件上传限制类型与大小，防止恶意攻击
- 日志与异常处理，保障系统稳定
- 遵循相关医疗数据合规要求（如脱敏、权限分级）

---

## 十、部署与运维建议

- 前端可部署于静态服务器（如 Nginx、Vercel、Netlify）
- 后端建议容器化部署（如 Docker），便于扩展与维护
- 数据库与文件存储定期备份
- 日志监控与告警，保障系统可用性

---

## 十一、后续迭代与扩展建议

- 对接真实后端API，实现数据持久化
- 增加多角色权限细分与管理后台
- 支持更多虚拟人形象与AI互动
- 优化表单验证与用户体验
- 增加数据统计与分析模块
- 支持移动端适配与PWA

---

如需详细原型图、接口文档或技术实现方案，请随时补充需求！ 