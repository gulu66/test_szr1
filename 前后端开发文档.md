# 前后端开发文档

## 一、项目简介

本系统为 AD 辅助系统，包含前端（React + Vite）和后端（建议 Node.js/Express 或 Python/FastAPI 等），实现病人管理、虚拟人管理、个性化回忆知识库等功能。前后端分离，接口通过 RESTful API 交互。

---

## 二、前端部分

### 1. 技术栈

- React 19
- react-router-dom 7
- @tanstack/react-query
- recharts
- Tailwind CSS
- Vite
- ESLint

### 2. 主要页面与功能

| 路径                | 说明                     |
|---------------------|--------------------------|
| `/login`            | 登录页                   |
| `/register`         | 注册页                   |
| `/`                 | 系统首页（仪表盘）       |
| `/patients`         | 病人列表                 |
| `/patients/add`     | 新增病人                 |
| `/patients/:id`     | 病人详情                 |
| `/avatars`          | 虚拟人列表               |
| `/avatars/add`      | 新增虚拟人               |
| `/avatars/:id`      | 虚拟人详情               |

### 3. 运行与开发

```bash
pnpm install
pnpm run dev
```

---

## 三、后端部分

### 1. 技术建议

- 推荐 Node.js (Express/Koa) 或 Python (FastAPI/Flask)
- 数据库建议：MongoDB、PostgreSQL、MySQL 等
- 文件存储：本地或云存储（如阿里云OSS、七牛云等）

### 2. 主要数据模型

#### 病人（Patient）

| 字段         | 类型     | 说明         |
|--------------|----------|--------------|
| id           | string   | 病人ID       |
| name         | string   | 姓名         |
| gender       | string   | 性别         |
| age          | number   | 年龄         |
| history      | string   | 病历病史     |
| memories     | array    | 个性化回忆   |

#### 个性化回忆（Memory）

| 字段         | 类型     | 说明         |
|--------------|----------|--------------|
| id           | string   | 回忆ID       |
| type         | string   | text/image   |
| content      | string   | 文本或图片URL|
| createdAt    | string   | 创建时间     |
| updatedAt    | string   | 更新时间     |

#### 虚拟人（Avatar）

| 字段         | 类型     | 说明         |
|--------------|----------|--------------|
| id           | string   | 虚拟人ID     |
| name         | string   | 名称         |
| description  | string   | 描述         |
| image        | string   | 形象图片URL  |
| voice        | string   | 声音文件URL  |
| agent        | string   | Agent类型    |
| type         | string   | 医生/亲属    |

---

### 3. API 设计

#### 用户认证

- `POST /api/register` 用户注册
- `POST /api/login` 用户登录
- `POST /api/logout` 用户登出

#### 病人管理

- `GET /api/patients` 获取病人列表
- `POST /api/patients` 新增病人
- `GET /api/patients/:id` 获取病人详情
- `PUT /api/patients/:id` 更新病人信息
- `DELETE /api/patients/:id` 删除病人

#### 个性化回忆管理

- `POST /api/patients/:id/memories` 新增回忆
- `PUT /api/patients/:id/memories/:memoryId` 编辑回忆
- `DELETE /api/patients/:id/memories/:memoryId` 删除回忆

#### 虚拟人管理

- `GET /api/avatars` 获取虚拟人列表
- `POST /api/avatars` 新增虚拟人
- `GET /api/avatars/:id` 获取虚拟人详情
- `PUT /api/avatars/:id` 更新虚拟人信息
- `DELETE /api/avatars/:id` 删除虚拟人

#### 文件上传

- `POST /api/upload/image` 上传图片
- `POST /api/upload/voice` 上传声音文件

---

### 4. 接口返回格式（示例）

```json
{
  "code": 0,
  "msg": "success",
  "data": { ... }
}
```

---

### 5. 安全与认证

- 推荐使用 JWT 进行用户认证
- 重要接口需校验用户登录态

---

### 6. 后端开发建议

- 按 RESTful 规范设计接口
- 合理使用 HTTP 状态码
- 日志与错误处理完善
- 文件上传建议限制大小与类型
- 预留接口扩展性（如分页、搜索、筛选）

---

## 四、前后端联调建议

- 前端通过 axios/fetch 调用后端 API
- 约定统一的接口返回格式
- 及时同步接口文档与字段变更
- 可使用 Postman/Swagger 进行接口测试

---

如需后端详细代码模板或某一接口的实现示例，请告知具体需求！ 